<div class="background-type"></div> <!--TODO: make bottom of the page update based on page size using javascript. Might be possible? -->

<!-- Left sidebar div containing stats and traits -->
<div style="width:175px;position:absolute;">
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
		<h4 style="margin:0px; margin-bottom:3px; text-align:center">Trait Total</h4>
		<input type="number" name="attr_totaltrait" readonly="true" style="float:right;"/>
		<h4 class="sheet-template-container" style="display:none;">Hide Roll:</h4>
        <input type="checkbox" name="attr_gmroll" value="1" class="sheet-template-container" style="display:none;">
	</div>

	<div class="stylized-type" style="width:170px; margin-bottom:6px;">
		<h4 style="display:block; margin:0px; margin-bottom:3px; text-align:center">Awareness</h4>
		
		<input type="number" name="attr_detection_mod" step="1" value="0"/>
		<button type="action" name="act_detection">Detection</button>
		<input type="checkbox" name="attr_detection_change">
		<br>
		<input type="number" name="attr_intuition_mod" step="1" value="0"/>
		<button type="action" name="act_intuition">Intuition</button>
		<input type="checkbox" name="attr_intuition_change">
		<br>
		<input type="number" name="attr_wilderness_mod" step="1" value="0"/>
		<button type="action" name="act_wilderness">Wilderness</button>
		<input type="checkbox" name="attr_wilderness_change">
	</div>

	<div class="stylized-type" style="width:170px; margin-bottom:6px;">
		<h4 style="display:block; margin:0px; margin-bottom:3px; text-align:center">Charisma</h4>
		
		<input type="number" name="attr_convince_mod" step="1" value="0"/>
		<button type="action" name="act_convince">Convince</button>
		<input type="checkbox" name="attr_convince_change">
		<br>
		<input type="number" name="attr_flair_mod" step="1" value="0"/>
		<button type="action" name="act_flair">Flair</button>
		<input type="checkbox" name="attr_flair_change">
		<br>
		<input type="number" name="attr_performance_mod" step="1" value="0"/>
		<button type="action" name="act_performance">Performance</button>
		<input type="checkbox" name="attr_performance_change">
	</div>

	<div class="stylized-type" style="width:170px; margin-bottom:6px;">
		<h4 style="display:block; margin:0px; margin-bottom:3px; text-align:center">Coordination</h4>
		
		<input type="number" name="attr_agility_mod" step="1" value="0"/>
		<button type="action" name="act_agility">Agility</button>
		<input type="checkbox" name="attr_agility_change">
		<br>
		<input type="number" name="attr_dexterity_mod" step="1" value="0"/>
		<button type="action" name="act_dexterity">Dexterity</button>
		<input type="checkbox" name="attr_dexterity_change">
		<br>
		<input type="number" name="attr_stealth_mod" step="1" value="0"/>
		<button type="action" name="act_stealth">Stealth</button>
		<input type="checkbox" name="attr_stealth_change">
	</div>

	<div class="stylized-type" style="width:170px; margin-bottom:6px;">
		<h4 style="display:block; margin:0px; margin-bottom:3px; text-align:center">Endurance</h4>
		
		<input type="number" name="attr_constitution_mod" step="1" value="0"/>
		<button type="action" name="act_constitution">Constitution</button>
		<input type="checkbox" name="attr_constitution_change">
		<br>
		<input type="number" name="attr_persistence_mod" step="1" value="0"/>
		<button type="action" name="act_persistence">Persistence</button>
		<input type="checkbox" name="attr_persistence_change">
		<br>
		<input type="number" name="attr_toughness_mod" step="1" value="0"/>
		<button type="action" name="act_toughness">Toughness</button>
		<input type="checkbox" name="attr_toughness_change">
	</div>

	<div class="stylized-type" style="width:170px; margin-bottom:6px;">
		<h4 style="display:block; margin:0px; margin-bottom:3px; text-align:center">Intelligence</h4>
		
		<input type="number" name="attr_engineering_mod" step="1" value="0"/>
		<button type="action" name="act_engineering">Engineering</button>
		<input type="checkbox" name="attr_engineering_change">
		<br>
		<input type="number" name="attr_knowledge_mod" step="1" value="0"/>
		<button type="action" name="act_knowledge">Knowledge</button>
		<input type="checkbox" name="attr_knowledge_change">
		<br>
		<input type="number" name="attr_magic_mod" step="1" value="0"/>
		<button type="action" name="act_magic">Magic</button>
		<input type="checkbox" name="attr_magic_change">
	</div>

	<div class="stylized-type" style="width:170px; margin-bottom:6px;">
		<h4 style="display:block; margin:0px; margin-bottom:3px; text-align:center">Power</h4>
		
		<input type="number" name="attr_grip_mod" step="1" value="0"/>
		<button type="action" name="act_grip">Grip</button>
		<input type="checkbox" name="attr_grip_change">
		<br>
		<input type="number" name="attr_physicality_mod" step="1" value="0"/>
		<button type="action" name="act_physicality">Physicality</button>
		<input type="checkbox" name="attr_physicality_change">
		<br>
		<input type="number" name="attr_presence_mod" step="1" value="0"/>
		<button type="action" name="act_presence">Presence</button>
		<input type="checkbox" name="attr_presence_change">
	</div>
	
	<div class="stylized-type" style="width:170px; margin-bottom:6px;">
		<h4 style="display:block; margin:0px; margin-bottom:3px; text-align:center">Spirit</h4>
		
		<input type="number" name="attr_faith_mod" step="1" value="0"/>
		<button type="action" name="act_faith">Faith</button>
		<input type="checkbox" name="attr_faith_change">
		<br>
		<input type="number" name="attr_interaction_mod" step="1" value="0"/>
		<button type="action" name="act_interaction">Interaction</button>
		<input type="checkbox" name="attr_interaction_change">
		<br>
		<input type="number" name="attr_willpower_mod" step="1" value="0"/>
		<button type="action" name="act_willpower">Willpower</button>
		<input type="checkbox" name="attr_willpower_change">
	</div>
	
	<div class="stylized-type" style="width:170px; margin-bottom:6px;">
	    <input type="checkbox" name="attr_mb">
		<input type="number" name="attr_melee_mod" step="1" value="3"/>
		<h4>Melee Bonus</h4>
		<br>
		<input type="checkbox" name="attr_rb">
		<input type="number" name="attr_ranged_mod" step="1" value="3"/>
		<h4>Ranged Bonus</h4>
		<br>
		<input type="checkbox" name="attr_tb">
		<input type="number" name="attr_thrown_mod" step="1" value="3"/>
		<h4>Thrown Bonus</h4>
		<br>
		<input type="checkbox" name="attr_sb">
		<input type="number" name="attr_spell_mod" step="1" value="3"/>
		<h4>Spell Bonus</h4>
		<br>
		<input type="checkbox" name="attr_bb">
		<input type="number" name="attr_block_mod" step="1" value="0"/>
		<h4>Block Bonus</h4>
		<br>
		<input type="checkbox" name="attr_db">
		<input type="number" name="attr_dodge_mod" step="1" value="0"/>
		<h4>Dodge Bonus</h4>
		<br>
		<input type="checkbox" name="attr_pb">
		<input type="number" name="attr_parry_mod" step="1" value="0"/>
		<h4>Parry Bonus</h4>
		<br>
		<input type="checkbox" name="attr_shield_bonus">
		<input type="number" name="attr_shield_mod" step="1" value="0"/>
		<h4>Shield</h4>
	</div>
</div>

<!-- Main div containing everything else -->
<div style="margin-left:195px;position:absolute;width:800px;">

<h1 style="margin-left:150px;">Legends Unbound Character Sheet</h1>

<br><br>

<!-- Section containing information about the character -->
<!-- Warning! Each input field must contain a name or else the information is not stored between sessions -->
<table style="margin: 0px auto;">
    <tr>
        <td>
            <h4>Name:</h4>
        </td>
        <td>
            <input type="text" name="attr_character_name" />
        </td>
		
        <td>
            <h4>Alignment:</h4>
        </td>
        <td>
            <input type="text" name="attr_character_alignment" />
        </td>
        
        <td>
            <h4>Player:</h4>
        </td>
        <td>
            <input type="text" name="attr_character_player" />
        </td>
    </tr>
    <tr>
        <td>
            <h4>Species:</h4>
        </td>
        <td>
            <input type="text" name="attr_character_species" />
        </td>
        
        <td>
            <h4>Size:</h4>
        </td>
        <td>
            <input type="text"  name="attr_character_size" />
        </td>
        
        <td>
            <h4>Background:</h4>
        </td>
        <td>
            <input type="text" name="attr_character_background" />
        </td>
    </tr>
</table>

<br>

<table style="text-align:center;margin:0px auto;">
    <tr>
	    <td style="padding:8px; border:1px grey solid;">
            <h4>Trait Advan.:</h4>
			<br>
			<input type="number" name="attr_traitadvan" step="1" value="0">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Attack Advan.:</h4>
			<br>
			<input type="number" name="attr_attackadvan" step="1" value="0">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Defense Advan.:</h4>
			<br>
			<input type="number" name="attr_defenseadvan" step="1" value="0">
		</td>
	</tr>
</table>

<br>

<table style="text-align:center;margin:0px auto;">
    <tr>
	    <td style="padding:8px; border:1px grey solid;">
	        <input type="checkbox" name="attr_traitcheck_change">
		    <br>
		    <h4>TC</h4>
			<br>
            <input type="number" name="attr_traitcheck"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
		    <h4>Hit Dice</h4>
			<br>
            <input type="number" name="attr_healthdice" />
			<br>
            <input type="text" name="attr_healthdice_type" style="width:50px;"/>
		</td>
	    <td style="padding:8px; border:1px grey solid;">
	        <input type="checkbox" name="attr_health_change">
		    <br>
		    <h4>Health</h4>
			<br>
            <input type="number" name="attr_health" />
			<br>
            <input type="number" name="attr_health_max" />
		</td>
		<td style="padding:8px; border:1px grey solid;">
		    <input type="checkbox" name="attr_deathmod_change">
		    <br>
		    <h4>Death</h4>
			<br>
            <input type="number" name="attr_death_mod" />
			<br>
            <button type="action" style="width:40px;" name="act_deathroll">Roll</button>
		</td>
		<td style="padding:8px; border:1px grey solid;">
		    <h4>Death Stacks</h4>
			<br>
            <input type="number" name="attr_deathstacks" />
			<br>
            <input type="number" name="attr_deathstacks_max" value="6"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
		    <h4>Nat. Armor</h4>
			<br>
            <input type="number" name="attr_natarmor" />
			<br>
            <input type="text" name="attr_natarmor_max" style="width:50px;" />
		</td>
		<td style="padding:8px; border:1px grey solid;">
		    <h4>Body Armor</h4>
			<br>
            <input type="number" name="attr_bodyarmor" />
			<br>
            <input type="text" name="attr_bodyarmor_max" style="width:50px;" />
		</td>
		<td style="padding:8px; border:1px grey solid;">
		    <input type="checkbox" name="attr_mana_change">
		    <br>
		    <h4>Mana</h4>
			<br>
            <input type="number" name="attr_mana" />
			<br>
            <input type="number" name="attr_mana_max" />
		</td>
		<td style="padding:8px; border:1px grey solid;">
		    <h4>Mana Dice</h4>
			<br>
            <input type="number" name="attr_manadice" />
			<br>
            <input type="text" name="attr_manadice_type" style="width:50px;"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
		    <input type="checkbox" name="attr_equip_change">
		    <h4>Equip. Slots</h4>
			<br>
            <input type="number" name="attr_equipslots" />
			<br>
            <input type="text" name="attr_equipslots_max" style="width:50px;"/>
		</td>
	</tr>
</table>

<br>

<table style="text-align:center;margin:0px auto;">
    <tr>
	    <td style="padding:8px; border:1px grey solid;">
            <h4>Blunt</h4>
			<br>
			<input type="number" name="attr_tolerance1"/>
			<br>
			<input type="checkbox" name="attr_blunt_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Caustic</h4>
			<br>
			<input type="number" name="attr_tolerance2"/>
			<br>
			<input type="checkbox" name="attr_caustic_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Cold</h4>
			<br>
			<input type="number" name="attr_tolerance3"/>
			<br>
			<input type="checkbox" name="attr_cold_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Death</h4>
			<br>
			<input type="number" name="attr_tolerance4"/>
			<br>
			<input type="checkbox" name="attr_death_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Electric</h4>
			<br>
			<input type="number" name="attr_tolerance5"/>
			<br>
			<input type="checkbox" name="attr_electric_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Heat</h4>
			<br>
			<input type="number" name="attr_tolerance6"/>
			<br>
			<input type="checkbox" name="attr_heat_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Light</h4>
			<br>
			<input type="number" name="attr_tolerance7"/>
			<br>
			<input type="checkbox" name="attr_light_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Poison</h4>
			<br>
			<input type="number" name="attr_tolerance9"/>
			<br>
			<input type="checkbox" name="attr_poison_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Psychic</h4>
			<br>
			<input type="number" name="attr_tolerance10"/>
			<br>
			<input type="checkbox" name="attr_psychic_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Puncture</h4>
			<br>
			<input type="number" name="attr_tolerance11"/>
			<br>
			<input type="checkbox" name="attr_puncture_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Sharp</h4>
			<br>
			<input type="number" name="attr_tolerance12"/>
			<br>
			<input type="checkbox" name="attr_sharp_change">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Sound</h4>
			<br>
			<input type="number" name="attr_tolerance13"/>
			<br>
			<input type="checkbox" name="attr_sound_change">
		</td>
	</tr>
</table>

<br>

<table style="text-align:center;margin:0px auto;">
    <tr>
	    <td style="padding:8px; border:1px grey solid;">
            <h4>Main Act.</h4>
			<br>
			<input type="checkbox" name="attr_ma1">
			<br>
			<input type="checkbox" name="attr_ma2">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Tact Act.</h4>
			<br>
			<input type="checkbox" name="attr_ta1">
			<br>
			<input type="checkbox" name="attr_ta2">
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Hand 1</h4>
			<br>
			<input type="text"  name="attr_hand_1" style="width:90px;"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Hand 2</h4>
			<br>
			<input type="text"  name="attr_hand_2" style="width:90px;"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Walking</h4>
			<br>
			<input type="number" name="attr_walking"/>
			<br>
			<input type="number" name="attr_walking_max"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Swimming</h4>
			<br>
			<input type="number" name="attr_swimming"/>
			<br>
			<input type="number" name="attr_swimming_max"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Flying</h4>
			<br>
			<input type="number" name="attr_flying"/>
			<br>
			<input type="number" name="attr_flying_max"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Jumping</h4>
			<br>
			<input type="number" name="attr_jumping"/>
			<br>
			<input type="number" name="attr_jumping_max"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Burrowing</h4>
			<br>
			<input type="number" name="attr_burrowing"/>
			<br>
			<input type="number" name="attr_burrowing_max"/>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Hovering</h4>
			<br>
			<input type="number" name="attr_hovering"/>
			<br>
			<input type="number" name="attr_hovering_max"/>
		</td>
	</tr>
</table>

<br>

<table style="text-align:center;margin:0px auto;padding:5px;">
    <tr>
        <td></td>
		<td>
		    <h4>Weapon:</h4>
		</td>
		<td>
		    <h4>Attack!</h4>
		</td>
		<td>
		    <h4>Damage:</h4>
		</td>
		<td>
		    <h4>Type(s):</h4>
		</td>
		<td>
		    <h4>Range<h4>
		</td>
		<td>
		    <h4>Lethal<h4>
		</td>
	<tr>
	<tr>
	    <td>
	        <input type="checkbox" name="attr_attack1_load" style="margin-left:5px;">
	        <input type="checkbox" name="attr_attack1_charge" style="margin-right:5px;">
	    </td>
	    <td>
		    <input type="text" name="attr_attack1_name">
		</td>
		<td>
		    <button type="action" style="width:15px;" name="act_attack1_m">M</button>
		    <button type="action" style="width:15px;" name="act_attack1_r">R</button>
		    <button type="action" style="width:15px;" name="act_attack1_t">T</button>
		    <button type="action" style="width:15px;" name="act_attack1_s">S</button>
		</td>
		<td>
		    <input type="text" name="attr_attack1_damage"/>
		</td>
		<td>
		    <input type="text" name="attr_attack1_damagetypes"/>
		</td>
        <td>
            <input type="number" name="attr_attack1_range" step="1" value="0"/>
        </td>
        <td>
            <input type="number" name="attr_attack1_crit" step="1" value="0"/>
        </td>
	</tr>
	<tr>
	    <td>
	        <input type="checkbox" name="attr_attack2_load" style="margin-left:5px;">
	        <input type="checkbox" name="attr_attack2_charge" style="margin-right:5px;">
	    </td>
	    <td>
		    <input type="text" name="attr_attack2_name">
		</td>
		<td>
		    <button type="action" style="width:15px;" name="act_attack2_m">M</button>
		    <button type="action" style="width:15px;" name="act_attack2_r">R</button>
		    <button type="action" style="width:15px;" name="act_attack2_t">T</button>
		    <button type="action" style="width:15px;" name="act_attack2_s">S</button>
		</td>
		<td>
		    <input type="text" name="attr_attack2_damage"/>
		</td>
		<td>
		    <input type="text" name="attr_attack2_damagetypes"/>
		</td>
		<td>
            <input type="number" name="attr_attack2_range" step="1" value="0"/>
        </td>
		<td>
            <input type="number" name="attr_attack2_crit" step="1" value="0"/>
        </td>
	</tr>
	<tr>
	    <td>
	        <input type="checkbox" name="attr_attack3_load" style="margin-left:5px;">
	        <input type="checkbox" name="attr_attack3_charge" style="margin-right:5px;">
	    </td>
	    <td>
		    <input type="text" name="attr_attack3_name">
		</td>
		<td>
		    <button type="action" style="width:15px;" name="act_attack3_m">M</button>
		    <button type="action" style="width:15px;" name="act_attack3_r">R</button>
		    <button type="action" style="width:15px;" name="act_attack3_t">T</button>
		    <button type="action" style="width:15px;" name="act_attack3_s">S</button>
		</td>
		<td>
		    <input type="text" name="attr_attack3_damage"/>
		</td>
		<td>
		    <input type="text" name="attr_attack3_damagetypes"/>
		</td>
		<td>
            <input type="number" name="attr_attack3_range" step="1" value="0"/>
        </td>
		<td>
            <input type="number" name="attr_attack3_crit" step="1" value="0"/>
        </td>
	</tr>
	<tr>
	    <td>
	        <input type="checkbox" name="attr_attack4_load" style="margin-left:5px;">
	        <input type="checkbox" name="attr_attack4_charge" style="margin-right:5px;">
	    </td>
	    <td>
		    <input type="text" name="attr_attack4_name">
		</td>
		<td>
		    <button type="action" style="width:15px;" name="act_attack4_m">M</button>
		    <button type="action" style="width:15px;" name="act_attack4_r">R</button>
		    <button type="action" style="width:15px;" name="act_attack4_t">T</button>
		    <button type="action" style="width:15px;" name="act_attack4_s">S</button>
		</td>
		<td>
		    <input type="text" name="attr_attack4_damage"/>
		</td>
		<td>
		    <input type="text" name="attr_attack4_damagetypes"/>
		</td>
		<td>
            <input type="number" name="attr_attack4_range" step="1" value="0"/>
        </td>
		<td>
            <input type="number" name="attr_attack4_crit" step="1" value="0"/>
        </td>
	</tr>
	<tr>
	    <td>
	        <input type="checkbox" name="attr_attack5_load" style="margin-left:5px;">
	        <input type="checkbox" name="attr_attack5_charge" style="margin-right:5px;">
	    </td>
	    <td>
		    <input type="text" name="attr_attack5_name">
		</td>
		<td>
		    <button type="action" style="width:15px;" name="act_attack5_m">M</button>
		    <button type="action" style="width:15px;" name="act_attack5_r">R</button>
		    <button type="action" style="width:15px;" name="act_attack5_t">T</button>
		    <button type="action" style="width:15px;" name="act_attack5_s">S</button>
		</td>
		<td>
		    <input type="text" name="attr_attack5_damage"/>
		</td>
		<td>
		    <input type="text" name="attr_attack5_damagetypes"/>
		</td>
		<td>
            <input type="number" name="attr_attack5_range" step="1" value="0"/>
        </td>
		<td>
            <input type="number" name="attr_attack5_crit" step="1" value="0"/>
        </td>
	</tr>
</table>

<br>

<table style="text-align:center;margin:0px auto;">
    <tr>
	    <td style="padding:8px; border:1px grey solid;">
            <button type="action" name="act_block" style="width:50px;">Block</button>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <button type="action" name="act_dodge" style="width:50px;">Dodge</button>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <button type="action" name="act_parry" style="width:50px;">Parry</button>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Status 1</h4>
			<br>
			<select name="attr_status1">
				<option>None</option>
				<option>Aggroed</option>
                <option>Blinded</option>
                <option>Charmed</option>
                <option>Confused</option>
                <option>Deafened</option>
                <option>Doomed</option>
                <option>Drunk</option>
                <option>Entangled</option>
                <option>Frightened</option>
                <option>Grappled</option>
                <option>Environmental</option>
                <option>Paralyzed</option>
                <option>Pinned</option>
                <option>Poisoned</option>
                <option>Silenced</option>
                <option>Sleeping</option>
                <option>Staggered</option>
                <option>Suffocating</option>
                <option>Wet</option>
                <option>Lingering Bruise</option>
                <option>Lingering Melt</option>
                <option>Lingering Frostbite</option>
                <option>Lingering Decay</option>
                <option>Lingering Shock</option>
                <option>Lingering Burn</option>
                <option>Lingering Shine</option>
                <option>Lingering Bleed</option>
                <option>Lingering Toxin</option>
                <option>Lingering Migraine</option>
                <option>Lingering Pierce</option>
                <option>Lingering Cut</option>
                <option>Lingering Noise</option>
			</select>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Status 2</h4>
			<br>
			<select name="attr_status2">
				<option>None</option>
				<option>Aggroed</option>
                <option>Blinded</option>
                <option>Charmed</option>
                <option>Confused</option>
                <option>Deafened</option>
                <option>Doomed</option>
                <option>Drunk</option>
                <option>Entangled</option>
                <option>Frightened</option>
                <option>Grappled</option>
                <option>Environmental</option>
                <option>Paralyzed</option>
                <option>Pinned</option>
                <option>Poisoned</option>
                <option>Silenced</option>
                <option>Sleeping</option>
                <option>Staggered</option>
                <option>Suffocating</option>
                <option>Wet</option>
                <option>Lingering Bruise</option>
                <option>Lingering Melt</option>
                <option>Lingering Frostbite</option>
                <option>Lingering Decay</option>
                <option>Lingering Shock</option>
                <option>Lingering Burn</option>
                <option>Lingering Shine</option>
                <option>Lingering Bleed</option>
                <option>Lingering Toxin</option>
                <option>Lingering Migraine</option>
                <option>Lingering Pierce</option>
                <option>Lingering Cut</option>
                <option>Lingering Noise</option>
			</select>
		</td>
		<td style="padding:8px; border:1px grey solid;">
            <h4>Status 3</h4>
			<br>
			<select name="attr_status3">
				<option>None</option>
				<option>Aggroed</option>
                <option>Blinded</option>
                <option>Charmed</option>
                <option>Confused</option>
                <option>Deafened</option>
                <option>Doomed</option>
                <option>Drunk</option>
                <option>Entangled</option>
                <option>Frightened</option>
                <option>Grappled</option>
                <option>Environmental</option>
                <option>Paralyzed</option>
                <option>Pinned</option>
                <option>Poisoned</option>
                <option>Silenced</option>
                <option>Sleeping</option>
                <option>Staggered</option>
                <option>Suffocating</option>
                <option>Wet</option>
                <option>Lingering Bruise</option>
                <option>Lingering Melt</option>
                <option>Lingering Frostbite</option>
                <option>Lingering Decay</option>
                <option>Lingering Shock</option>
                <option>Lingering Burn</option>
                <option>Lingering Shine</option>
                <option>Lingering Bleed</option>
                <option>Lingering Toxin</option>
                <option>Lingering Migraine</option>
                <option>Lingering Pierce</option>
                <option>Lingering Cut</option>
                <option>Lingering Noise</option>
			</select>
		</td>
	</tr>
</table>

<br>

<div style="width:45%;text-align:center;display:inline-block;margin-left:3%;vertical-align: top;">
    <h4>Class Abilities</h4><h4>
    <br>
    <textarea style="width:100%;" rows="4" name="attr_textbox1"></textarea>
    <h4>Spells<h4>
	<br>
	<textarea style="width:100%;" rows="13" name="attr_textbox2"></textarea>
</div>

<div style="width:45%;text-align:center;display:inline-block;margin-left:2%;vertical-align: top;">
    <h4>Species Abilities<h4>
	<br>
	<textarea style="width:100%;" rows="18" name="attr_textbox3"></textarea>
	<h4>Equipment<h4>
	<br>
	<textarea style="width:100%;" rows="18" name="attr_textbox4"></textarea>
</div>

<!-- End div for main panel -->
</div>

<div style="margin-left:1000px;position:absolute;">
    
    <div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <h4 style="margin:0px; margin-bottom:3px; text-align:center">Level</h4>
	    <input type="number" name="attr_level" style="float:right;"/>
	</div>
    <div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <h4 style="margin:0px; margin-bottom:3px; text-align:center">Essence</h4>
	    <input type="number" name="attr_essence" style="float:right;"/>
	    <input type="number" name="attr_essence_max" style="float:right;" value="0" />
	</div>
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <h4 style="margin:0px; margin-bottom:3px; text-align:center">Short Rest</h4>
	    <input type="number" name="attr_shortrest" style="float:right;"/>
	    <input type="number" name="attr_shortrest_max" style="float:right;" value="0" />
	</div>
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <h4 style="margin:0px; margin-bottom:3px; text-align:center">Long Rest</h4>
	    <input type="number" name="attr_longrest" style="float:right;"/>
	    <input type="number" name="attr_longrest_max" style="float:right;" value="0" />
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main1"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num1" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max1" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main2"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num2" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max2" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main3"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num3" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max3" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main4"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num4" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max4" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main5"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num5" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max5" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main6"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num6" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max6" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main7"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num7" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max7" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main8"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num8" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max8" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main9"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num9" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max9" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main10"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num10" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max10" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main11"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num11" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max11" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main12"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num12" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max12" style="width:80px;"/>
	    <br>
	</div>
	
	<div class="stylized-type" style="width:170px; padding-bottom: 10px; margin-bottom:6px;">
	    <input type="text" name="attr_abilitytracker_main13"/>
	    <br>
	    <input type="number" name="attr_abilitytracker_num13" style="width:80px;"/>
	    <input type="number" name="attr_abilitytracker_max13" style="width:80px;"/>
	    <br>
	</div>

<!-- All HTML code for the character sheet itself is above this. -->
</div>

<!-- Displays roll results in Roll20's chat -->
<!-- Hidden on the character sheet inside Roll20, but displays oddly if this file is loaded as pure .html -->
<!-- TODO: Beautify -->
<rolltemplate class="sheet-rolltemplate-r_template">
    <!-- For some reason, it does not appear that Roll20's StartRoll() function
    is inherently capable of creating GM-only rolls (i.e. rolls that only the GM can see).
    As this was client-requested behaviour, a work-around had to be introduced.
    
    The following is a nasty trick to hide rolls from clients. In essence, if the "hide-rolls"
    button is checked, the roll template will output a roll set to 'display:none;'. 
    In order for the GM to see the roll, they need to set up a third-party browser extension
    (such as Stylus) with the following snippet of CSS:
    .sheet-template-container {
        display:block !important;
    }
    
    This will force the rolls to show on the GM's screen and allow them to make "hidden" rolls.
    These rolls are entirely insecure, as not only can any user configure such a browser extension,
    they can also right-click and select "Inspect" to view the roll's result regardless.
    However, as most players will presumably not be inherently aware of these options, security
    on a very small scale will most likely be a non-issue.
    
    As a side-note, this feature has mild quality-of-life issues, as hidden rolls still take up
    space in the chat for all players. -->
    
    <!-- Version of the roll shown to all players -->
    {{#rollTotal() hide 0}}
    <div class="sheet-template-container" style="border-style:groove; padding-left:10px;">
        <h3>{{name}}</h3>
        <div class="sheet-results">
            <h4 style="margin-bottom:3px;">{{character}}</h4>
            
            <!-- If crit success, show crit roll value in green -->
            {{#rollGreater() computed::roll roll}}
                <h4 style="color:#00D300;">{{computed::roll}}</h4>
            {{/rollGreater() computed::roll roll}}
            
            <!-- If fumble, show fumble roll value in red -->
            {{#rollLess() computed::roll roll}}
                <h4 style="color:red;">{{computed::roll}}</h4>
            {{/rollLess() computed::roll roll}}
            
            <!-- Otherwise, show default roll value -->
            {{#rollTotal() computed::roll roll}}
                <h4>{{roll}}</h4>
            {{/rollTotal() computed::roll roll}}
            
            <!-- If an attack, show damage -->
            {{#rollTotal() rolltype 1}}
                <h4>Damage: {{damage}}</h4>
                <h4>Extra: {{crit}}</h4>
                <h4>Attack Type: {{atktype}}</h4>
                <h4>Damage Type: {{dmgtype}}</h4>
            {{/rollTotal() rolltype 1}}
        </div>
    </div>
    {{/rollTotal() hide 0}}
    
    <!-- Version of the roll only shown to players using a third-party application to specifically force it to show -->
    {{#rollTotal() hide 1}}
    <div class="sheet-template-container" style="border-style:groove; padding-left:10px; display:none;">
        <h3>{{name}}</h3>
        <div class="sheet-results">
            <h4 style="margin-bottom:3px;">{{character}}</h4>
            
            <!-- If crit success, show crit roll value in green -->
            {{#rollGreater() computed::roll roll}}
                <h4 style="color:#00D300;">{{computed::roll}}</h4>
            {{/rollGreater() computed::roll roll}}
            
            <!-- If fumble, show fumble roll value in red -->
            {{#rollLess() computed::roll roll}}
                <h4 style="color:red;">{{computed::roll}}</h4>
            {{/rollLess() computed::roll roll}}
            
            <!-- Otherwise, show default roll value -->
            {{#rollTotal() computed::roll roll}}
                <h4>{{roll}}</h4>
            {{/rollTotal() computed::roll roll}}
            
            <!-- If an attack, show damage -->
            {{#rollTotal() rolltype 1}}
                <h4>Damage: {{damage}}</h4>
                <h4>Extra: {{crit}}</h4>
                <h4>Attack Type: {{atktype}}</h4>
                <h4>Damage Type: {{dmgtype}}</h4>
            {{/rollTotal() rolltype 1}}
        </div>
    </div>
    {{/rollTotal() hide 1}}
</rolltemplate>

<script type="text/worker">
    
    on("change:detection_mod change:intuition_mod change:wilderness_mod change:convince_mod change:flair_mod change:performance_mod change:agility_mod change:dexterity_mod change:stealth_mod change:constitution_mod change:persistence_mod change:toughness_mod change:engineering_mod change:knowledge_mod change:magic_mod change:grip_mod change:physicality_mod change:presence_mod change:faith_mod change:interaction_mod change:willpower_mod sheet:opened", function() {  
        getAttrs(["detection_mod","intuition_mod","wilderness_mod","convince_mod","flair_mod","performance_mod","agility_mod","dexterity_mod","stealth_mod","constitution_mod","persistence_mod","toughness_mod","engineering_mod","knowledge_mod","magic_mod","grip_mod","physicality_mod","presence_mod","faith_mod","interaction_mod","willpower_mod"], function(values) {
            let val = parseInt(values.detection_mod) + parseInt(values.intuition_mod) + parseInt(values.wilderness_mod) + parseInt(values.convince_mod) + parseInt(values.flair_mod) + parseInt(values.performance_mod) + parseInt(values.agility_mod) + parseInt(values.dexterity_mod) + parseInt(values.stealth_mod) + parseInt(values.constitution_mod) + parseInt(values.persistence_mod) + parseInt(values.toughness_mod) + parseInt(values.engineering_mod) + parseInt(values.knowledge_mod) + parseInt(values.magic_mod) + parseInt(values.grip_mod) + parseInt(values.physicality_mod) + parseInt(values.presence_mod) + parseInt(values.faith_mod) + parseInt(values.interaction_mod) + parseInt(values.willpower_mod)
            setAttrs({                            
                "totaltrait": val
            });
        });
    });
    
    on('clicked:deathroll', (info) => {
        getAttrs(["death_mod"], function(values) {
			_makeRoll("trait", "Death/Soul Roll", values.death_mod, null, null, null, null);
        });
    });
    
    on('clicked:detection', (info) => {
        getAttrs(["detection_mod"], function(values) {
			_makeRoll("trait", "Detection", values.detection_mod, null, null, null, null);
        });
    });
    
    on('clicked:intuition', (info) => {
        getAttrs(["intuition_mod"], function(values) {
			_makeRoll("trait", "Intuition", values.intuition_mod, null, null, null, null);
        });
    });
    
    on('clicked:wilderness', (info) => {
        getAttrs(["wilderness_mod"], function(values) {
			_makeRoll("trait", "Wilderness", values.wilderness_mod, null, null, null, null);
        });
    });
    
    on('clicked:convince', (info) => {
        getAttrs(["convince_mod"], function(values) {
			_makeRoll("trait", "Convince", values.convince_mod, null, null, null, null);
        });
    });
    
    on('clicked:flair', (info) => {
        getAttrs(["flair_mod"], function(values) {
			_makeRoll("trait", "Flair", values.flair_mod, null, null, null, null);
        });
    });
    
    on('clicked:performance', (info) => {
        getAttrs(["performance_mod"], function(values) {
			_makeRoll("trait", "Performance", values.performance_mod, null, null, null, null);
        });
    });
    
    on('clicked:agility', (info) => {
        getAttrs(["agility_mod"], function(values) {
			_makeRoll("trait", "Agility", values.agility_mod, null, null, null, null);
        });
    });
    
    on('clicked:dexterity', (info) => {
        getAttrs(["dexterity_mod"], function(values) {
			_makeRoll("trait", "Dexterity", values.dexterity_mod, null, null, null, null);
        });
    });
    
    on('clicked:stealth', (info) => {
        getAttrs(["stealth_mod"], function(values) {
			_makeRoll("trait", "Stealth", values.stealth_mod, null, null, null, null);
        });
    });
    
    on('clicked:constitution', (info) => {
        getAttrs(["constitution_mod"], function(values) {
			_makeRoll("trait", "Constitution", values.constitution_mod, null, null, null, null);
        });
    });
    
    on('clicked:persistence', (info) => {
        getAttrs(["persistence_mod"], function(values) {
			_makeRoll("trait", "Persistence", values.persistence_mod, null, null, null, null);
        });
    });
    
    on('clicked:toughness', (info) => {
        getAttrs(["toughness_mod"], function(values) {
			_makeRoll("trait", "Toughness", values.toughness_mod, null, null, null, null);
        });
    });
    
    on('clicked:engineering', (info) => {
        getAttrs(["engineering_mod"], function(values) {
			_makeRoll("trait", "Engineering", values.engineering_mod, null, null, null, null);
        });
    });
    
    on('clicked:knowledge', (info) => {
        getAttrs(["knowledge_mod"], function(values) {
			_makeRoll("trait", "Knowledge", values.knowledge_mod, null, null, null, null);
        });
    });
    
    on('clicked:magic', (info) => {
        getAttrs(["magic_mod"], function(values) {
			_makeRoll("trait", "Magic", values.magic_mod, null, null, null, null);
        });
    });
    
    on('clicked:grip', (info) => {
        getAttrs(["grip_mod"], function(values) {
			_makeRoll("trait", "Grip", values.grip_mod, null, null, null, null);
        });
    });
    
    on('clicked:physicality', (info) => {
        getAttrs(["physicality_mod"], function(values) {
			_makeRoll("trait", "Physicality", values.physicality_mod, null, null, null, null);
        });
    });
    
    on('clicked:presence', (info) => {
        getAttrs(["presence_mod"], function(values) {
			_makeRoll("trait", "Presence", values.presence_mod, null, null, null, null);
        });
    });
    
    on('clicked:faith', (info) => {
        getAttrs(["faith_mod"], function(values) {
			_makeRoll("trait", "Faith", values.faith_mod, null, null, null, null);
        });
    });
    
    on('clicked:interaction', (info) => {
        getAttrs(["interaction_mod"], function(values) {
			_makeRoll("trait", "Interaction", values.interaction_mod, null, null, null, null);
        });
    });
    
    on('clicked:willpower', (info) => {
        getAttrs(["willpower_mod"], function(values) {
			_makeRoll("trait", "Willpower", values.willpower_mod, null, null, null, null);
        });
    });
    
    
    
    on('clicked:block', (info) => {
        getAttrs(["block_mod","shield_mod"], function(values) {
            _makeRoll("defense", "Block", parseInt(values.block_mod) + parseInt(values.shield_mod), null, null, null, null);
        });
    });
    
    on('clicked:dodge', (info) => {
        getAttrs(["dodge_mod","shield_mod"], function(values) {
            _makeRoll("defense", "Dodge", parseInt(values.dodge_mod) + parseInt(values.shield_mod), null, null, null, null);
        });
    });
    
    on('clicked:parry', (info) => {
        getAttrs(["parry_mod","shield_mod"], function(values) {
            _makeRoll("defense", "Parry", parseInt(values.parry_mod) + parseInt(values.shield_mod), null, null, null, null);
        });
    });
    
    
    
    on('clicked:attack1_m', (info) => {
        getAttrs(["melee_mod", "attack1_name", "attack1_damage", "attack1_crit", "attack1_damagetypes", "attack1_range"], function(values) {
            _makeRoll("attack", values.attack1_name, values.melee_mod, "Melee " + values.attack1_range, values.attack1_damagetypes, values.attack1_damage, values.attack1_crit);
        });
    });
    
    on('clicked:attack1_r', (info) => {
        getAttrs(["ranged_mod", "attack1_name", "attack1_damage", "attack1_crit", "attack1_damagetypes"], function(values) {
            _makeRoll("attack", values.attack1_name, values.ranged_mod, "Ranged " + values.attack1_range, values.attack1_damagetypes, values.attack1_damage, values.attack1_crit);
        });
    });
    
    on('clicked:attack1_t', (info) => {
        getAttrs(["thrown_mod", "attack1_name", "attack1_damage", "attack1_crit", "attack1_damagetypes"], function(values) {
            _makeRoll("attack", values.attack1_name, values.thrown_mod, "Thrown " + values.attack1_range, values.attack1_damagetypes, values.attack1_damage, values.attack1_crit);
        });
    });
    
    on('clicked:attack1_s', (info) => {
        getAttrs(["spell_mod", "attack1_name", "attack1_damage", "attack1_crit", "attack1_damagetypes"], function(values) {
            _makeRoll("attack", values.attack1_name, values.spell_mod, "Spell " + values.attack1_range, values.attack1_damagetypes, values.attack1_damage, values.attack1_crit);
        });
    });
    
    on('clicked:attack2_m', (info) => {
        getAttrs(["melee_mod", "attack2_name", "attack2_damage", "attack2_crit", "attack2_damagetypes"], function(values) {
            _makeRoll("attack", values.attack2_name, values.melee_mod, "Melee " + values.attack2_range, values.attack2_damagetypes, values.attack2_damage, values.attack2_crit);
        });
    });
    
    on('clicked:attack2_r', (info) => {
        getAttrs(["ranged_mod", "attack2_name", "attack2_damage", "attack2_crit", "attack2_damagetypes"], function(values) {
            _makeRoll("attack", values.attack2_name, values.ranged_mod, "Ranged " + values.attack2_range, values.attack2_damagetypes, values.attack2_damage, values.attack2_crit);
        });
    });
    
    on('clicked:attack2_t', (info) => {
        getAttrs(["thrown_mod", "attack2_name", "attack2_damage", "attack2_crit", "attack2_damagetypes"], function(values) {
            _makeRoll("attack", values.attack2_name, values.thrown_mod, "Thrown " + values.attack2_range, values.attack2_damagetypes, values.attack2_damage, values.attack2_crit);
        });
    });
    
    on('clicked:attack2_s', (info) => {
        getAttrs(["spell_mod", "attack2_name", "attack2_damage", "attack2_crit", "attack2_damagetypes"], function(values) {
            _makeRoll("attack", values.attack2_name, values.spell_mod, "Spell " + values.attack2_range, values.attack2_damagetypes, values.attack2_damage, values.attack2_crit);
        });
    });
    
    on('clicked:attack3_m', (info) => {
        getAttrs(["melee_mod", "attack3_name", "attack3_damage", "attack3_crit", "attack3_damagetypes"], function(values) {
            _makeRoll("attack", values.attack3_name, values.melee_mod, "Melee " + values.attack3_range, values.attack3_damagetypes, values.attack3_damage, values.attack3_crit);
        });
    });
    
    on('clicked:attack3_r', (info) => {
        getAttrs(["ranged_mod", "attack3_name", "attack3_damage", "attack3_crit", "attack3_damagetypes"], function(values) {
            _makeRoll("attack", values.attack3_name, values.ranged_mod, "Ranged " + values.attack3_range, values.attack3_damagetypes, values.attack3_damage, values.attack3_crit);
        });
    });
    
    on('clicked:attack3_t', (info) => {
        getAttrs(["thrown_mod", "attack3_name", "attack3_damage", "attack3_crit", "attack3_damagetypes"], function(values) {
            _makeRoll("attack", values.attack3_name, values.thrown_mod, "Thrown " + values.attack3_range, values.attack3_damagetypes, values.attack3_damage, values.attack3_crit);
        });
    });
    
    on('clicked:attack3_s', (info) => {
        getAttrs(["spell_mod", "attack3_name", "attack3_damage", "attack3_crit", "attack3_damagetypes"], function(values) {
            _makeRoll("attack", values.attack3_name, values.spell_mod, "Spell " + values.attack3_range, values.attack3_damagetypes, values.attack3_damage, values.attack3_crit);
        });
    });
    
    on('clicked:attack4_m', (info) => {
        getAttrs(["melee_mod", "attack4_name", "attack4_damage", "attack4_crit", "attack4_damagetypes"], function(values) {
            _makeRoll("attack", values.attack4_name, values.melee_mod, "Melee " + values.attack4_range, values.attack4_damagetypes, values.attack4_damage, values.attack4_crit);
        });
    });
    
    on('clicked:attack4_r', (info) => {
        getAttrs(["ranged_mod", "attack4_name", "attack4_damage", "attack4_crit", "attack4_damagetypes"], function(values) {
            _makeRoll("attack", values.attack4_name, values.ranged_mod, "Ranged " + values.attack4_range, values.attack4_damagetypes, values.attack4_damage, values.attack4_crit);
        });
    });
    
    on('clicked:attack4_t', (info) => {
        getAttrs(["thrown_mod", "attack4_name", "attack4_damage", "attack4_crit", "attack4_damagetypes"], function(values) {
            _makeRoll("attack", values.attack4_name, values.thrown_mod, "Thrown " + values.attack4_range, values.attack4_damagetypes, values.attack4_damage, values.attack4_crit);
        });
    });
    
    on('clicked:attack4_s', (info) => {
        getAttrs(["spell_mod", "attack4_name", "attack4_damage", "attack4_crit", "attack4_damagetypes"], function(values) {
            _makeRoll("attack", values.attack4_name, values.spell_mod, "Spell " + values.attack4_range, values.attack4_damagetypes, values.attack4_damage, values.attack4_crit);
        });
    });
    
    
    on('clicked:attack5_m', (info) => {
        getAttrs(["melee_mod", "attack5_name", "attack5_damage", "attack5_crit", "attack5_damagetypes"], function(values) {
            _makeRoll("attack", values.attack5_name, values.melee_mod, "Melee " + values.attack5_range, values.attack5_damagetypes, values.attack5_damage, values.attack5_crit);
        });
    });
    
    on('clicked:attack5_r', (info) => {
        getAttrs(["ranged_mod", "attack5_name", "attack5_damage", "attack5_crit", "attack5_damagetypes"], function(values) {
            _makeRoll("attack", values.attack5_name, values.ranged_mod, "Ranged " + values.attack5_range, values.attack5_damagetypes, values.attack5_damage, values.attack5_crit);
        });
    });
    
    on('clicked:attack5_t', (info) => {
        getAttrs(["thrown_mod", "attack5_name", "attack5_damage", "attack5_crit", "attack5_damagetypes"], function(values) {
            _makeRoll("attack", values.attack5_name, values.thrown_mod, "Thrown " + values.attack5_range, values.attack5_damagetypes, values.attack5_damage, values.attack5_crit);
        });
    });
    
    on('clicked:attack5_s', (info) => {
        getAttrs(["spell_mod", "attack5_name", "attack5_damage", "attack5_crit", "attack5_damagetypes"], function(values) {
            _makeRoll("attack", values.attack5_name, values.spell_mod, "Spell " + values.attack5_range, values.attack5_damagetypes, values.attack5_damage, values.attack5_crit);
        });
    });
    
    
    //Function to make a dice roll
	const _makeRoll = (rolltype, rollname, bonus, attacktype, damagetype, rolldice, critdmg) => {
	    getAttrs(["traitadvan", "attackadvan", "defenseadvan", "gmroll", "character_name"], function(values) {
	        //get global values
            let hiddenroll = parseInt(values.gmroll);
			let charname = values.character_name;
			let advan = 0;
			let damagetext = "0";
            let crittext = "0";
            if(rolltype === "attack"){
                damagetext = `${rolldice}`;
                crittext = `${rolldice} + ${critdmg}`;
                rolltype = "1";
                advan = parseInt(values.attackadvan);
            }
            else{
                if(rolltype === "trait"){
                    advan = parseInt(values.traitadvan);
                }
                else{
                    advan = parseInt(values.defenseadvan);
                }
                rolltype = "0"
            }
			
			//determine dice roll
            let rolltext = "";
            if(advan >= 0){
                //If player has advantage, take highest
                rolltext = `[[2 + ${advan}]]d10kh2cs>21cf<0 + ${bonus}`;
            } else {
                //If player has disadvanatage, take lowest
                //I have no idea why "2 + ${advan} * -1" works, but "2 - ${advan}" doesn't
                rolltext = `[[2 + ${advan} * -1]]d10kl2cs>21cf<0 + ${bonus}`;
            }
            
			//TODO: Roll parameters::
			//>Name of roll
			//>Name of roll's instigator
			//>Type of roll (whether should do damage, whether thrown or spellcast, etc.)
			//>Bonus to the roll
			//>Amount of advantage on the roll
			//>Type of dice to roll
			//>Damage required
			//??Extra damage on a crit
			//>Whether the roll should be hidden
			//??Can you decompose rolls? Because if so, then it'd be great to show every roll immediately with advantage
			//??In fact, whether the roll's internals should be shown at all is a legitimate question
    	    startRoll(`&{template:r_template} {{hide=[[${hiddenroll}d1]]}} {{name=${rollname}}} {{character=${charname}}} {{roll=[[${rolltext}]]}} {{rolltype=[[${rolltype}d1]]}} {{atktype=${attacktype}}} {{dmgtype=${damagetype}}} {{damage=[[${damagetext}]]}} {{crit=${critdmg}}}`, (results) => {
                let original = results.results.roll.result;
                let computed = original - bonus;
                
                //Determines if the number is a crit
                //computed cannot be directly compared to an integer using "==", so comparisons are instead made using ">"
                if(computed > 19){
                    computed  = original * 2;
                }else if(computed < 3) {
                    computed = Math.ceil(original / 2);
                } else {
                    computed = original;
                }
    
                finishRoll(
                    results.rollId,
                    {
                        roll: computed
                    }
                );
            });
	    });
	}
</script>
